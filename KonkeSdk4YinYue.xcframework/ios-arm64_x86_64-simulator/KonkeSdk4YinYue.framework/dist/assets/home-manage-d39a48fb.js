import{_ as v,c as h,a as k,b as u,i as r,w as i,j as l,F as p,o as t,r as D,t as U,d as y,e as L}from"./_plugin-vue_export-helper-b237bda9.js";import{I as x}from"./index-48d5ec75.js";import{D as b}from"./index-ae174569.js";/* empty css              */import{B as E}from"./index-551494da.js";/* empty css              *//* empty css              */import{C as N}from"./index-996b5610.js";import{C as A}from"./index-2718965a.js";import{_ as S}from"./nav-bar-25466e0a.js";import{h as B,C as F,M as j}from"./api-3a266929.js";import{a as V}from"./function-call-870d27f5.js";import"./index-c7c816a4.js";import"./use-touch-5cae3072.js";import"./use-route-f0a1f66c.js";import"./index-85a17d82.js";const z={name:"KonkeSdk4YinYueSrcApp",data(){return{homeUserList:[],homeList:[],currentHome:{},showExitHomeDialog:!1}},mounted(){this.getHomes(),window.__eventBus.on("reload",()=>{this.getHomes()})},methods:{async onAccept(s){try{await B({HUID:s.HUID,status:2})}catch(m){V(m.info)}},async onExitHome(){await F({HUID:this.currentHome.HUID}),await this.getHomes()},toDetail(){window.__jsb.push({route:"home-manage-detail",params:{homeId:this.currentHome.homeId}})},changeHome(s){this.currentHome=s,window.__homeId=s.homeId,window.__jsb.setUserDefaults({key:"homeId",value:s.homeId}),localStorage.setItem("homeId",s.homeId),window.__jsb.forwardEvent({eventName:"home-changed"})},async getHomes(){try{const{data:s}=await j(),{homeList:m,homeUserList:_}=s;_.forEach(e=>{e.home.isShare=!0,e.home.HUID=e.HUID}),this.homeList=m||[],this.homeUserList=_||[];const a=[...this.homeList,...this.homeUserList.map(e=>e.home)];if(a.length>0){const e=a.map(c=>c.homeId+""),n=localStorage.getItem("homeId")||"";e.includes(n)?window.__homeId=n:(window.__homeId=a[0].homeId,localStorage.setItem("homeId",a[0].homeId)),this.currentHome=a.find(c=>c.homeId==window.__homeId)}else this.currentHome={}}catch(s){console.log(s)}},onAddNew(){window.__jsb.push({route:"home-create"})}}},R={class:"home-manage"},T={style:{"margin-right":"10px"}},Y=["onClick"],G={key:1,class:"accepted"};function K(s,m,_,a,e,n){const c=S,g=x,w=A,I=N,H=E,C=b;return t(),h(p,null,[k("div",R,[u(c,{title:"家庭管理","right-text":"新建",onClickRight:n.onAddNew},null,8,["onClickRight"]),e.homeUserList.length>0?(t(),r(I,{key:0,inset:"",title:"分享的家庭"},{default:i(()=>[(t(!0),h(p,null,D(e.homeUserList,(o,d)=>(t(),r(w,{key:d,size:"large",onClick:f=>n.changeHome(o.home)},{title:i(()=>[k("span",T,U(o.home.homeName),1),o.status==1?(t(),h("span",{key:0,class:"accept-button",onClick:f=>n.onAccept(o)},"接受",8,Y)):o.status==2?(t(),h("span",G,"已接受")):l("",!0)]),"right-icon":i(()=>[e.currentHome.homeId==o.home.homeId?(t(),r(g,{key:0,name:"success",color:"#FD7D28"})):l("",!0)]),_:2},1032,["onClick"]))),128))]),_:1})):l("",!0),u(I,{inset:"",title:"我的家庭"},{default:i(()=>[(t(!0),h(p,null,D(e.homeList,(o,d)=>(t(),r(w,{key:d,title:o.homeName,size:"large",onClick:f=>n.changeHome(o)},{"right-icon":i(()=>[e.currentHome.homeId==o.homeId?(t(),r(g,{key:0,name:"success",color:"#FD7D28"})):l("",!0)]),_:2},1032,["title","onClick"]))),128))]),_:1}),e.currentHome.isShare?(t(),r(H,{key:1,color:"red",class:"manage-button",onClick:m[0]||(m[0]=o=>e.showExitHomeDialog=!0)},{default:i(()=>[y("退出家庭")]),_:1})):(t(),r(H,{key:2,type:"primary",color:"#FD7D28FF",class:"manage-button",onClick:n.toDetail},{default:i(()=>[y("家庭管理")]),_:1},8,["onClick"]))]),u(C,{show:e.showExitHomeDialog,"onUpdate:show":m[1]||(m[1]=o=>e.showExitHomeDialog=o),title:"是否退出该家庭？",message:"退出后将无法访问该家庭","show-cancel-button":"",onConfirm:n.onExitHome},null,8,["show","onConfirm"])],64)}const M=v(z,[["render",K],["__scopeId","data-v-175094ec"]]);L(M).mount("#root");
