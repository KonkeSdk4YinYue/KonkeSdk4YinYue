import{_ as u,c as f,b as d,w as I,k as w,v as C,a,o as y,p as g,f as N,l as D,e as L}from"./_plugin-vue_export-helper-b237bda9.js";import"./index-48d5ec75.js";/* empty css              *//* empty css              */import"./index-2718965a.js";import{F as T}from"./index-0e89bf2d.js";import{_ as b}from"./nav-bar-25466e0a.js";import{R as k}from"./room-component-da37607d.js";import{S as R}from"./scene-action-light-component-712d1e3d.js";import{b as S,p as P,q as V,t as j,u as h,v as x,r as A}from"./api-3f328c0d.js";import{g as U}from"./urlparse-f25d0f77.js";import{a as r}from"./function-call-870d27f5.js";import{P as E}from"./index-c7c816a4.js";import"./use-route-f0a1f66c.js";import"./use-id-06d20740.js";import"./use-touch-5cae3072.js";import"./index-1df323c1.js";import"./index-2521a990.js";import"./index-996b5610.js";/* empty css              */import"./index-e42d5b3f.js";import"./index-23e1586e.js";import"./index-85a17d82.js";const O={components:{SceneActionLight:R,RoomListPop:k},data(){return{devName:"",room_sel_show:!1,roomList:[],roomName:"",roomId:-1,devId:-1,typeName:"电视",userDevice:{},rcType:"",codeId:-1,keyList:[],codeType:"",isNewCode:!1}},mounted(){this.getUrlParams(),window.__eventBus.on("infraredLibCode",e=>{console.log(e),this.rcType=e.rcType,this.typeName=this.rcType=="AC"?"空调":this.rcType=="TV"?"电视":"风扇",this.codeId=e.codeId,this.codeType=e.codeType,this.isNewCode=!0})},methods:{getUrlParams(){let e=window.location.search;const o=U(e);console.log(o),o!=null&&"devId"in o&&(this.devId=o.devId,console.log(this.devId),this.devId!=null&&this.devId!=-1&&this.getDevInfo())},getDevInfo(){S({userDeviceId:this.devId}).then(e=>{var n;if(console.log(e),this.userDevice=e.data.userDeviceList[0],this.roomName=(n=e.data.userDeviceList[0])==null?void 0:n.roomName,this.roomId=e.data.userDeviceList[0].roomId,this.devName=e.data.userDeviceList[0].deviceName,this.userDevice.userExtension!=""){var o=JSON.parse(this.userDevice.userExtension);this.rcType=o.rcType,this.typeName=this.rcType=="AC"?"空调":this.rcType=="TV"?"电视":"风扇"}}).catch(e=>r(e))},onClickLeft(){window.__jsb.pop()},onClickRight(){if(this.devName==""){r("请输入设备名称");return}if(this.roomId==-1){r("请选择房间");return}try{if(this.isNewCode){if(this.codeType=="cloud"){const e={};e.codeId=255,e.channelId=this.userDevice.nodeId,e.isMajor=!0,e.rcType="AC";const o={};o.roomId=this.userDevice.roomId,o.parentDeviceId=this.userDevice.parentUserDeviceId,o.isMaster=!1,o.remoteList=e,o.deviceName=this.userDevice.deviceName,o.nodeId=this.userDevice.nodeId;const n={};n.rcType="AC",o.extension=JSON.stringify(n),console.log("device: ",o),P(o).then(l=>{console.log("createDevice",l),V(this.devId,255,this.userDevice.nodeId,!1,this.rcType,this.keyList).then(t=>{j(this.devId,255,this.userDevice.nodeId).then(s=>{h(this.devId,this.devName,this.roomId).then(p=>{window.__jsb.forwardEvent({eventName:"reload",fromPage:"devedit",toPage:""})})}).catch(s=>{r(s)}),console.log("bindcodelib",t)})}).catch(l=>{console.log("err",l)})}}else h(this.devId,this.devName,this.roomId).then(e=>{window.__jsb.forwardEvent({eventName:"reload",fromPage:"devedit",toPage:""}),window.__jsb.pop()})}catch(e){r(e)}},toSelType(){window.__jsb.push({route:"dev-infrared-type",params:{devId:this.devId,nodeId:this.userDevice.nodeId}})},delDev(){x(this.devId).then(e=>{window.__jsb.forwardEvent({eventName:"reload",eventData:"",fromPage:"devedit",toPage:""}),window.__jsb.pop()}).catch(e=>{r(e)})},selRoom(){this.room_sel_show=!0,A().then(e=>{e.code==200?this.roomList=e.data.roomList:r(e.info)})},onRoomSelCancel(){this.room_sel_show=!1},onRoomSelConfirm(e){console.log("onRoomSelConfirm",e),this.roomName=e.roomName,this.roomId=e.roomId,this.room_sel_show=!1}}},m=e=>(g("data-v-3f0739c5"),e=e(),N(),e),B={class:"home"},F=m(()=>a("div",{class:"name_hint"}," 设备名称 ",-1)),J=m(()=>a("div",{class:"name_hint"}," 房间 ",-1)),M=m(()=>a("div",{class:"name_hint"}," 红外配置 ",-1));function q(e,o,n,l,t,s){const p=b,c=T,v=D("RoomListPop"),_=E;return y(),f("div",B,[d(p,{class:"nav_bar",title:"编辑设备","right-text":"保存",onClickRight:s.onClickRight,onClickLeft:s.onClickLeft},null,8,["onClickRight","onClickLeft"]),F,d(c,{class:"input",modelValue:t.devName,"onUpdate:modelValue":o[0]||(o[0]=i=>t.devName=i),clearable:"",placeholder:"请输入设备名称"},null,8,["modelValue"]),J,d(c,{class:"input",modelValue:t.roomName,"onUpdate:modelValue":o[1]||(o[1]=i=>t.roomName=i),onClick:s.selRoom,"right-icon":"arrow ",readonly:"",placeholder:"请选择房间"},null,8,["modelValue","onClick"]),M,d(c,{class:"input",modelValue:t.typeName,"onUpdate:modelValue":o[2]||(o[2]=i=>t.typeName=i),onClick:s.toSelType,"right-icon":"arrow ",readonly:"",placeholder:"请选择红外类型"},null,8,["modelValue","onClick"]),d(_,{show:t.room_sel_show,"onUpdate:show":o[3]||(o[3]=i=>t.room_sel_show=i),position:"bottom"},{default:I(()=>[d(v,{list:t.roomList,onOnCancal:s.onRoomSelCancel,onOnConfirm:s.onRoomSelConfirm},null,8,["list","onOnCancal","onOnConfirm"])]),_:1},8,["show"]),w(a("div",{class:"del_text",onClick:o[4]||(o[4]=(...i)=>s.delDev&&s.delDev(...i))},"删除设备",512),[[C,t.devId!=null&&t.devId!=-1]])])}const z=u(O,[["render",q],["__scopeId","data-v-3f0739c5"]]);L(z).mount("#root");
