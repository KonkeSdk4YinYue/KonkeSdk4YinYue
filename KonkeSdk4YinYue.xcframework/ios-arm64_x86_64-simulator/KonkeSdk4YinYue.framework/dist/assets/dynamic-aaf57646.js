import{_ as L,o as i,c as p,F as S,r as x,a as s,d,b as c,n as k,g as b,e as l,j as _,f as O,k as V,i as F}from"./_plugin-vue_export-helper-ae94e834.js";import"./index-5198b2b7.js";import{L as z}from"./index-3d928aae.js";import{N as E,A as j,B as H}from"./notice_icon-db89d479.js";import{P as q}from"./index-ca2a2be7.js";import{_ as J}from"./dynamic-cell-eae223cb.js";import{E as U}from"./index-44c3c42c.js";import{B as G}from"./index-46966e79.js";import{_ as w}from"./teenager-limit-c0a84a00.js";import{I as K}from"./index-9cad779b.js";import{_ as Q}from"./safe-area-top-6391331c.js";import{_ as W}from"./gradient-top-303d3c33.js";import{S as B,a as X,b as C,c as T,d as I}from"./index-af5b6666.js";/* empty css              */import{A as g}from"./api-3777ac7b.js";import"./use-expose-833097fe.js";import"./use-tab-status-ea9b54fd.js";import"./use-touch-b8f7fc8d.js";import"./accost-button-621bb3da.js";import"./default_female_avatar-3bbfb1af.js";import"./function-call-d8608672.js";import"./index-c49f2c8f.js";import"./index-6f826b23.js";import"./on-popup-reopen-34d1e964.js";import"./interceptor-c174082f.js";import"./constant-eb256a74.js";import"./default_male_avatar-835185e5.js";import"./real_person-47fbf4f0.js";import"./use-id-b8b960f0.js";import"./use-route-fa444ad9.js";const Y={name:"Home",components:{Skeleton:B,SkeletonTitle:X,SkeletonImage:C,SkeletonAvatar:T,SkeletonParagraph:I},data(){return{}}},Z={class:"home-page-skeleton"},$={style:{width:"100%",marginTop:"20px",marginBottom:"20px"}},ee={style:{display:"flex",width:"100%",marginTop:"20px",marginBottom:"20px"}},te={style:{display:"flex",flexDirection:"column",width:"100%"}},ne={style:{display:"flex",marginTop:"10px"}};function se(n,e,h,u,t,o){const f=T,r=I,m=C,y=B;return i(),p("div",Z,[(i(),p(S,null,x(4,v=>s(y,{row:3,key:v},{template:d(()=>[c("div",$,[c("div",ee,[s(f,{"avatar-size":"48"}),c("div",te,[s(r,{"row-width":"40%"}),s(r)])]),s(r),s(r),s(r),c("div",ne,[s(m,{"image-size":"108",style:{marginRight:"16px"}}),s(m,{"image-size":"108",style:{marginRight:"16px"}}),s(m,{"image-size":"108"})])])]),_:2},1024)),64))])}const oe=L(Y,[["render",se],["__scopeId","data-v-e0bc46ad"]]);const ie={name:"Dynamic",components:{TeenagerLimit:w,Skeleton:oe},data(){return{NoticeIcon:E,AddIcon:j,list:[],isRefreshing:!1,isLoadingMore:!1,isFinished:!1,pageLoading:!1,tab:"dynamic",teenager:!1}},created(){this.pageLoading=!0,this.loadMore(),this.getStorageParams(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.getStorageParams()})},methods:{async getStorageParams(){const n=localStorage.getItem("defaultSettings");if(n){const{teenager:e}=JSON.parse(n);this.teenager=e}},toNotice(){__jsb.push({route:"dynamic-notice"})},toPublish(){__jsb.push({route:"dynamic-publish"})},async loadMore(){if(!this.minId){this.isLoadingMore=!1;return}try{const n=this.tab==="dynamic"?g.getSquareHistory(this.minId):g.getConcernsHistory(this.minId),{data:e}=await n;this.list=this.list.concat(e),this.isFinished=e.length===0}catch(n){console.log(n)}finally{this.isLoadingMore=!1,this.pageLoading=!1}},async refresh(){try{const n=this.tab==="dynamic"?g.getSquareNews():g.getConcernsNews(),{data:e}=await n;this.list=e}catch(n){this.list=[],console.log(n)}finally{this.isRefreshing=!1,this.isFinished=this.list.length===0,this.pageLoading=!1}},switchTab(n){this.tab=n,this.refresh()}},mounted(){this.refresh(),__eventBus.on("dynamic-like-changed",n=>{const{id:e,likeCount:h,myLike:u}=JSON.parse(n),t=this.list.find(o=>o.accountDynamicBO.id===e);t&&(t.accountDynamicBO.myLike=u,t.accountDynamicBO.likeCount=h)}),__eventBus.on("dynamic-publish-new",()=>{this.refresh()})},computed:{minId(){var n,e;return(e=(n=this.list[this.list.length-1])==null?void 0:n.accountDynamicBO)==null?void 0:e.id},hasData(){return this.list.length>0},dynamicTabClass(){return["title",this.tab==="dynamic"?"active":""]},concernsTabClass(){return["title",this.tab==="concerns"?"active":""]}}},ae={class:"venus-dynamic"},re={class:"navbar"};function ce(n,e,h,u,t,o){const f=W,r=Q,m=K,y=w,v=G,D=U,N=J,P=q,R=H,A=z,M=V("Skeleton");return i(),p("div",ae,[s(f),s(r),c("div",re,[c("div",{class:k(o.dynamicTabClass),onClick:e[0]||(e[0]=b(()=>o.switchTab("dynamic"),["stop"]))},"动态",2),c("div",{class:k(o.concernsTabClass),onClick:e[1]||(e[1]=b(()=>o.switchTab("concerns"),["stop"]))},"关注",2),l("",!0)]),t.teenager?(i(),_(y,{key:0})):l("",!0),!o.hasData&&!t.teenager&&!t.pageLoading?(i(),_(D,{key:1,description:"暂无数据"},{default:d(()=>[s(v,{round:"",class:"bottom-button",onClick:o.refresh,loading:t.isRefreshing},{default:d(()=>[O("刷新")]),_:1},8,["onClick","loading"])]),_:1})):l("",!0),o.hasData&&!t.teenager&&!t.pageLoading?(i(),_(A,{key:2,loading:t.isLoadingMore,"onUpdate:loading":e[4]||(e[4]=a=>t.isLoadingMore=a),finished:t.isFinished,onLoad:o.loadMore,"immediate-check":!1,class:"scrollable"},{default:d(()=>[s(P,{modelValue:t.isRefreshing,"onUpdate:modelValue":e[3]||(e[3]=a=>t.isRefreshing=a),onRefresh:o.refresh},{default:d(()=>[(i(!0),p(S,null,x(t.list,a=>(i(),_(N,{key:a.accountDynamicBO.id,item:a,canShowDetail:!0},null,8,["item"]))),128))]),_:1},8,["modelValue","onRefresh"]),s(R)]),_:1},8,["loading","finished","onLoad"])):l("",!0),!t.teenager&&!t.pageLoading?(i(),p("div",{key:3,class:"dynamic-add",onClick:e[5]||(e[5]=(...a)=>o.toPublish&&o.toPublish(...a))},[s(m,{src:t.AddIcon,width:"18px",height:"18px"},null,8,["src"])])):l("",!0),t.pageLoading?(i(),_(M,{key:4})):l("",!0)])}const le=L(ie,[["render",ce],["__scopeId","data-v-6d03b022"]]),me=F(le);me.mount("#root");
