import{_ as u,c as d,b as _,a as o,t as l,w as g,o as r,F as D,r as w,j as f,p as k,d as I,e as b}from"./_plugin-vue_export-helper-441d49bc.js";import"./index-3c7dc3c1.js";import{G as x,a as y}from"./index-aded244a.js";import{_ as U}from"./nav-bar-d5f559a7.js";import{E as L,e as a}from"./api-cff82ee0.js";import{g as B}from"./dev-image-f6fc399c.js";import{g as C}from"./urlparse-f25d0f77.js";import{a as i}from"./function-call-06d9c54b.js";import"./use-route-ace38816.js";import"./use-touch-a55357c8.js";import"./index-9bebd057.js";import"./index-1c01d136.js";const S=""+new URL("ic_network_zigbee-f14eba9d.svg",import.meta.url).href;const T={name:"KonkeSdk4YinYueSrcApp",data(){return{network_text:"组网中...",networkBtnText:"停止组网",deviceList:[],getDevImage:B,gatewayUserDeviceId:0,isDiscovering:!1}},mounted(){window.__eventBus.on("Joined",e=>{console.log("_eventBus.on",e),this.deviceList.push(e)}),this.getUrlParams(),this.openDevDiscover()},unmounted(){this.isDiscovering&&this.stopDevDiscover()},methods:{getUrlParams(){let e=window.location.search;const t=C(e);console.log(t),t!=null&&"gatewayUserDeviceId"in t&&(this.gatewayUserDeviceId=t.gatewayUserDeviceId,console.log(this.devId))},onClickLeft(){window.__jsb.pop()},clickItem(e){window.__jsb.push({route:"devedit",params:{devId:e.userDeviceId}})},openDevDiscover(){this.gatewayUserDeviceId==0?L().then(e=>{if(e.data.userDeviceList==null||e.data.userDeviceList.length==0){i("请用扫一扫添加网关");return}this.gatewayUserDeviceId=e.data.userDeviceList[0].userDeviceId,a(this.gatewayUserDeviceId,"SetDiscoverZigbeeOn").then(t=>{this.isDiscovering=!0,this.networkBtnText="停止组网",this.network_text="组网中..."}).catch(t=>i(t))}).catch(e=>i(e)):a(this.gatewayUserDeviceId,"SetDiscoverZigbeeOn").then(e=>{console.log(e),this.isDiscovering=!0,this.networkBtnText="停止组网",this.network_text="组网中..."}).catch(e=>i(e))},stopDevDiscover(){if(!this.isDiscovering){this.openDevDiscover();return}a(this.gatewayUserDeviceId,"SetDiscoverZigbeeOff").then(e=>{this.isDiscovering=!1,this.networkBtnText="开始组网",this.network_text="组网结束"}).catch(e=>i(e))}}},v=e=>(k("data-v-57cb6cf0"),e=e(),I(),e),j={class:"home"},A=v(()=>o("img",{class:"ic_network",src:S},null,-1)),G={class:"tv_network"},N=v(()=>o("div",{class:"divider"},null,-1)),O=v(()=>o("div",{class:"net_hint"},"已入网设备",-1));function P(e,t,z,E,c,n){const p=U,h=y,m=x;return r(),d("div",j,[_(p,{class:"nav_bar",title:"组网",onClickLeft:n.onClickLeft},null,8,["onClickLeft"]),A,o("div",G,l(c.network_text),1),N,O,_(m,{class:"grid",direction:"horizontal",gutter:10,"column-num":2,clickable:"true"},{default:g(()=>[(r(!0),d(D,null,w(c.deviceList,s=>(r(),f(h,{class:"dev_item",key:s.userDeviceId,onClick:F=>n.clickItem(s),icon:c.getDevImage(s.device.cateType),text:s.deviceName},null,8,["onClick","icon","text"]))),128))]),_:1}),o("div",{class:"btn_stop",onClick:t[0]||(t[0]=(...s)=>n.stopDevDiscover&&n.stopDevDiscover(...s))},l(c.networkBtnText),1)])}const Z=u(T,[["render",P],["__scopeId","data-v-57cb6cf0"]]);b(Z).mount("#root");
