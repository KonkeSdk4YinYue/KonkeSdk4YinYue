import{_ as w,o as c,c as _,F,r as b,a as l,d as u,b as a,n as L,j as x,e as f,f as g,t as d,k as U,i as H}from"./_plugin-vue_export-helper-ae94e834.js";import"./index-5198b2b7.js";import{B as j}from"./index-46966e79.js";import{F as G}from"./index-f273d662.js";import{P as O}from"./index-ca2a2be7.js";import{L as z}from"./index-3d928aae.js";import{I as E}from"./index-9cad779b.js";import{_ as q}from"./dynamic-cell-eae223cb.js";import{_ as J}from"./navbar-dd7c7647.js";import{_ as A,M as K}from"./action-popover-ac49e5e1.js";import{_ as Q}from"./safe-area-top-6391331c.js";import{D as W}from"./default_female_avatar-3bbfb1af.js";import{D as X}from"./default_male_avatar-835185e5.js";import{G as Y,a as Z}from"./gender_male_icon-54da54d1.js";import{R as $}from"./real_person-47fbf4f0.js";import{A as h}from"./api-3777ac7b.js";import{S as P,a as ee,b as te,c as B,d as C}from"./index-af5b6666.js";import{a as I}from"./function-call-d8608672.js";import"./use-route-fa444ad9.js";import"./constant-eb256a74.js";import"./use-id-b8b960f0.js";import"./use-expose-833097fe.js";import"./use-touch-b8f7fc8d.js";import"./use-tab-status-ea9b54fd.js";import"./accost-button-621bb3da.js";/* empty css              *//* empty css              */import"./index-c49f2c8f.js";import"./index-6f826b23.js";import"./on-popup-reopen-34d1e964.js";import"./interceptor-c174082f.js";import"./index-91e6daf5.js";const oe={name:"Home",components:{Skeleton:P,SkeletonTitle:ee,SkeletonImage:te,SkeletonAvatar:B,SkeletonParagraph:C},data(){return{}}},ne={class:"home-page-skeleton"},se={style:{width:"100%",marginTop:"20px",marginBottom:"20px",overflow:"hidden"}},ae={style:{display:"flex",width:"100%",marginTop:"20px",marginBottom:"20px"}},ie={style:{display:"flex",flex:1,flexDirection:"column",width:"100%"}};function le(n,t,s,i,e,m){const v=B,p=C,y=P;return c(),_("div",ne,[(c(),_(F,null,b(4,k=>l(y,{row:3,key:k},{template:u(()=>[a("div",se,[a("div",ae,[l(v,{"avatar-size":"48"}),a("div",ie,[l(p,{"row-width":"40%"}),l(p)])]),l(p,{style:{marginLeft:"64px"}})])]),_:2},1024)),64))])}const re=w(oe,[["render",le],["__scopeId","data-v-f33bac8b"]]);const ce={name:"VenusApp",components:{ActionPopover:A,Skeleton:re},data(){return{FemaleIcon:Y,MaleIcon:Z,RealIcon:$,FemaleAvatar:W,MaleAvatar:X,MoreIcon:K,initItem:{},loading:!1,subLoading:!1,finished:!1,refreshing:!1,comment:"",isFocus:!1,isFollow:!1,isBlack:!1,pageLoading:!1,commentList:[],detailData:{}}},created(){this.pageLoading=!0},async mounted(){this.initData()},methods:{async handleReport(){var s,i;const n=(s=this.reportContent.find(e=>e.active))==null?void 0:s.text,t=(i=this.reportReason.find(e=>e.active))==null?void 0:i.text;if(!n){I("请选择举报内容");return}if(!t){I("请选择举报原因");return}await h.reportUser({location:n,reason:t,reportedUserId:this.detailData.userId}),I("举报成功"),this.showDialog=!1},handleSelect(n,t="content"){t==="content"?this.reportContent=this.reportContent.map(s=>({...s,active:s.text===n.text})):this.reportReason=this.reportReason.map(s=>({...s,active:s.text===n.text}))},onToggleLike(){console.log("onToggleLike2");const{id:n,likeCount:t,myLike:s}=this.initItem.accountDynamicBO;__jsb.forwardEvent({eventName:"dynamic-like-changed",eventData:JSON.stringify({id:n,likeCount:t,myLike:s}),fromPage:"dynamic-detail",toPage:"dynamic"})},handleFocus(){this.isFocus=!0,setTimeout(()=>{let n=document.querySelector(".venus-dynamic-detail"),t=n.getBoundingClientRect().top,s=n.offsetHeight;n.style.height=parseInt(s+t)+"px"},20),setTimeout(()=>{window.scroll(0,0)},21)},async handleSubmit(){if(!this.comment)return;const{id:n}=this;this.subLoading=!0;try{await h.addDynamicComment({dynamicId:n,comment:this.comment}),this.onRefresh()}finally{this.comment="",this.subLoading=!1}},onRefresh(){this.refreshing=!0,this.initData(!0)},initData(n=!1){this.getPageParams(n)},async getCommentList(n=!1){var i;if(!(this!=null&&this.id))return;this.loading=!0;const t=((i=this.commentList)==null?void 0:i[this.commentList.length-1])||{},s=n?0:(t==null?void 0:t.id)||0;try{const{data:e}=await h.getDynamicComment({id:this.id,minId:s});console.log(e,"data"),(!Array.isArray(e)||(e==null?void 0:e.length)<10)&&(this.finished=!0),n?this.commentList=e:this.commentList=[...this.commentList,...e]}finally{this.loading=!1,this.refreshing=!1,this.pageLoading=!1}console.log(this.loading,"loading"),console.log(this.finished,"finished")},async getPageParams(n=!1){const t=await __jsb.getPageParams();this.initItem=t.item;const{accountDynamicBO:s}=t.item,{id:i}=s||{};this.id=i,this.getCommentList(n),this.refreshDetail(i)},async refreshDetail(n=this.id){try{const{data:t}=await h.getDynamicDetail(n);this.detailData=t;const{concern:s}=t;this.isFollow=s;const{data:i}=await h.checkIsBlack(t==null?void 0:t.userId);this.isBlack=i}catch(t){console.log(t)}}}},me={class:"venus-dynamic-detail"},de={class:"scroll-comment"},_e={class:"scroll-comment-title"},pe={class:"comment-count"},he={class:"like-count"},ue={class:"comment-right"},fe={class:"comment-name"},ge={class:"comment-info"},ve=["src"],ye=["src"],ke={class:"comment-time"},Le={class:"comment-text"};function xe(n,t,s,i,e,m){const v=Q,p=A,y=J,k=q,R=E,T=z,S=U("skeleton"),V=O,M=G,N=j;return c(),_("div",me,[l(v),l(y,{title:"动态详情"},{default:u(()=>{var r;return[l(p,{"user-id":(r=e.detailData)==null?void 0:r.userId},null,8,["user-id"])]}),_:1}),a("div",{class:L(["scrollable",{"is-focus":e.isFocus}])},[l(V,{modelValue:e.refreshing,"onUpdate:modelValue":t[1]||(t[1]=r=>e.refreshing=r),onRefresh:m.onRefresh},{default:u(()=>{var r,D;return[e.initItem!=={}?(c(),x(k,{key:0,item:e.initItem,onToggleLike:m.onToggleLike},null,8,["item","onToggleLike"])):f("",!0),a("div",de,[a("div",_e,[a("span",null,[g(" 评论 "),a("span",pe,d(((r=e.detailData)==null?void 0:r.commentCount)??0),1)]),a("span",null,[a("span",he,d(((D=e.detailData)==null?void 0:D.likeCount)??0),1),g(" 赞 ")])]),e.pageLoading?f("",!0):(c(),x(T,{key:0,loading:e.loading,"onUpdate:loading":t[0]||(t[0]=o=>e.loading=o),finished:e.finished,"finished-text":"没有更多了哦 ~ ",onLoad:m.getCommentList},{default:u(()=>[(c(!0),_(F,null,b(e.commentList,o=>(c(),_("div",{class:"comment-item",key:o.id},[l(R,{width:"36",height:"36",src:o!=null&&o.headPic?o==null?void 0:o.headPic:(o==null?void 0:o.gender)===2?e.FemaleAvatar:e.MaleAvatar,fit:"cover",radius:"15",class:"comment-pic"},null,8,["src"]),a("div",ue,[a("div",fe,d(o==null?void 0:o.nickName),1),a("div",ge,[a("div",{class:L(["comment-gender",{male:(o==null?void 0:o.gender)!==2}])},[a("img",{src:o.gender==2?e.FemaleIcon:e.MaleIcon},null,8,ve),g(" "+d((o==null?void 0:o.age)||0),1)],2),o!=null&&o.isReal?(c(),_("img",{key:0,src:e.RealIcon,class:"comment-real"},null,8,ye)):f("",!0),a("span",ke,d(o==null?void 0:o.commentTime),1)]),a("div",Le,d(o.comment),1)])]))),128))]),_:1},8,["loading","finished","onLoad"])),e.pageLoading?(c(),x(S,{key:1})):f("",!0)])]}),_:1},8,["modelValue","onRefresh"]),a("div",{class:L(["dynamic-detail-input",{"is-focus":e.isFocus}])},[l(M,{modelValue:e.comment,"onUpdate:modelValue":t[2]||(t[2]=r=>e.comment=r),placeholder:"说说你的想法",maxlength:"500",onFocus:m.handleFocus,onBlur:t[3]||(t[3]=r=>e.isFocus=!1)},null,8,["modelValue","onFocus"]),l(N,{round:"",block:"",disabled:!e.comment,loading:e.subLoading,onTouchstart:m.handleSubmit},{default:u(()=>[g(" 发送 ")]),_:1},8,["disabled","loading","onTouchstart"])],2)],2)])}const Ie=w(ce,[["render",xe],["__scopeId","data-v-623592d0"]]);H(Ie).mount("#root");
