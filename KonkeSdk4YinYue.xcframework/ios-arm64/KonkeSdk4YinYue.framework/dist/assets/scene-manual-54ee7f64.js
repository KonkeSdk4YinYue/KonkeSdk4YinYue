import{_ as g,c as m,b as l,F as L,r as w,a as s,w as C,f as I,v as S,o as r,t as h,p as R,e as N,g as k,h as x}from"./_plugin-vue_export-helper-c6b04c4a.js";import"./index-31b7c571.js";/* empty css              */import"./index-7bc1b107.js";import{F as b}from"./index-c30f7602.js";import{_ as A}from"./nav-bar-721d5a93.js";import{R as P,_ as V,a as D}from"./ic_scene_add_action-888c5285.js";import{S as O}from"./scene-action-light-component-164e5297.js";import{h as j,i as d,j as y,r as U}from"./api-94f50879.js";import{g as B}from"./urlparse-f25d0f77.js";import{p}from"./scene-cfbe032f.js";import{s as c}from"./function-call-8de52e48.js";import{P as F}from"./index-03f6bb18.js";import"./use-route-3612c525.js";import"./use-id-23bdf568.js";import"./use-touch-c5100371.js";import"./index-066b1e6c.js";import"./index-d2ea230b.js";import"./index-7882f3c6.js";/* empty css              */import"./index-8310b73f.js";import"./index-860b8b59.js";import"./index-22da9197.js";import"./dev-image-f6fc399c.js";import"./ic_scene1-0f866639.js";const M={components:{SceneActionLight:O,RoomListPop:P},data(){return{scenename:"",item:null,value:0,room_sel_show:!1,roomList:[],roomName:"",roomId:-1,actionList:[],sceneId:-1}},mounted(){this.getUrlParams(),window.__eventBus.on("addDevAction",o=>{o=p(o),this.actionList.push(o)})},methods:{getUrlParams(){let o=window.location.search;const e=B(o);console.log(e),e!=null&&"sceneId"in e&&(this.sceneId=e.sceneId,console.log(this.sceneId),this.sceneId!=null&&this.sceneId!=-1&&this.getSceneDetail())},getSceneDetail(){j(this.sceneId).then(o=>{o.data.sceneList.length>0?(this.scenename=o.data.sceneList[0].sceneName,this.roomName=o.data.sceneList[0].roomName,this.roomId=o.data.sceneList[0].roomId,this.actionList=o.data.sceneList[0].actionList,this.actionList.forEach(e=>{e.extension=JSON.parse(e.extension),e=p(e)})):c(o.info)}).catch(o=>console.log(o))},onClickLeft(){window.__jsb.pop()},onClickRight(){if(this.scenename==""){c("请输入情景名称");return}if(this.roomId==-1){c("请选择房间");return}if(this.actionList==null||this.actionList.length==0){c("最少要包含一个动作");return}this.actionList.forEach(o=>{o.extension!=null&&o.extension!=""&&(o.extension=JSON.stringify(o.extension))}),this.sceneId==-1?d(this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.pop()}).catch(o=>console.log(o)):y(this.sceneId,this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.pop()}).catch(o=>console.log(o))},selRoom(){this.room_sel_show=!0,U().then(o=>{o.code==200?this.roomList=o.data.roomList:c(o.info)})},onRoomSelCancel(){this.room_sel_show=!1},onRoomSelConfirm(o){console.log("onRoomSelConfirm",o),this.roomName=o.roomName,this.roomId=o.roomId,this.room_sel_show=!1},addAction(){window.__jsb.push({route:"scene-action-type"})},actionRemove(o){this.actionList.splice(this.actionList.indexOf(o),1)}}},a=o=>(R("data-v-e589c4e2"),o=o(),N(),o),E={class:"home"},J=a(()=>s("div",{class:"name_hint"}," 场景名称 ",-1)),T=a(()=>s("div",{class:"name_hint"}," 房间 ",-1)),q=a(()=>s("div",{class:"name_hint"}," 执行动作 ",-1)),z={class:"action"},G={class:"action_list"},H=["src"],K={class:"action_info"},Q={class:"action_dev_name"},W={class:"action_exec_name"},X=a(()=>s("div",{class:"divider"},null,-1)),Y=a(()=>s("img",{class:"add_action_icon",src:D},null,-1)),Z=a(()=>s("div",{class:"add_action_name"},"添加执行动作",-1)),$=[Y,Z];function oo(o,e,so,to,n,i){const u=A,_=b,f=k("RoomListPop"),v=F;return r(),m("div",E,[l(u,{class:"nav_bar",title:"手动场景","right-text":"保存",onClickRight:i.onClickRight,onClickLeft:i.onClickLeft},null,8,["onClickRight","onClickLeft"]),J,l(_,{class:"input",modelValue:n.scenename,"onUpdate:modelValue":e[0]||(e[0]=t=>n.scenename=t),clearable:"",placeholder:"请输入场景名称"},null,8,["modelValue"]),T,l(_,{class:"input",modelValue:n.roomName,"onUpdate:modelValue":e[1]||(e[1]=t=>n.roomName=t),onClick:i.selRoom,"right-icon":"arrow ",readonly:"",placeholder:"请选择房间"},null,8,["modelValue","onClick"]),q,(r(!0),m(L,null,w(n.actionList,t=>(r(),m("div",z,[s("div",G,[s("img",{class:"action_icon",src:t.icon},null,8,H),s("div",K,[s("div",Q,h(t.actionDevShowName),1),s("div",W,h(t.actionShowName),1)]),s("img",{class:"ic_remove",src:V,onClick:e[2]||(e[2]=no=>{i.actionRemove(n.item)})})]),X]))),256)),s("div",{class:"add_action",onClick:e[3]||(e[3]=(...t)=>i.addAction&&i.addAction(...t))},$),l(v,{show:n.room_sel_show,"onUpdate:show":e[4]||(e[4]=t=>n.room_sel_show=t),position:"bottom"},{default:C(()=>[l(f,{list:n.roomList,onOnCancal:i.onRoomSelCancel,onOnConfirm:i.onRoomSelConfirm},null,8,["list","onOnCancal","onOnConfirm"])]),_:1},8,["show"]),I(s("div",{class:"del_text",onClick:e[5]||(e[5]=(...t)=>o.deleteRoom&&o.deleteRoom(...t))},"删除场景",512),[[S,n.sceneId!=null&&n.sceneId!=-1]])])}const eo=g(M,[["render",oo],["__scopeId","data-v-e589c4e2"]]);x(eo).mount("#root");
