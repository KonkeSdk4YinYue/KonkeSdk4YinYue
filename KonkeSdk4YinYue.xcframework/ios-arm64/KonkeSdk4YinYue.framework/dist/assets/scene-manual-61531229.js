import{_ as v,c as r,a as c,F as g,r as L,f as s,w as S,h as C,v as I,o as m,t as h,p as R,e as b,i as N,g as k}from"./_plugin-vue_export-helper-4adca727.js";import"./index-f4bb52ea.js";/* empty css              *//* empty css              */import"./index-f891a278.js";import{F as x}from"./index-62ed2467.js";import{_ as j}from"./nav-bar-188b05ac.js";import{R as A}from"./room-component-897ebb95.js";import{S as P}from"./scene-action-light-component-82fd6845.js";import{n as V,o as d,p as y,q as D,r as O}from"./api-b5274a4f.js";import{g as E}from"./urlparse-f25d0f77.js";import{p}from"./scene-cfbe032f.js";import{_ as U,a as B}from"./ic_scene_add_action-3488ce3c.js";import{a}from"./function-call-8db26e1c.js";import{P as F}from"./index-28bb2e26.js";import"./use-route-710f3c49.js";import"./use-id-f8db432d.js";import"./use-expose-f66499b2.js";import"./index-72aa8aef.js";import"./index-c18c9d52.js";import"./index-12218a2e.js";/* empty css              */import"./index-3866edd4.js";import"./use-touch-330ddaa2.js";import"./index-d761a1b1.js";import"./index-08ecd083.js";import"./dev-image-f6fc399c.js";import"./ic_scene1-0f866639.js";const M={components:{SceneActionLight:P,RoomListPop:A},data(){return{scenename:"",item:null,value:0,room_sel_show:!1,roomList:[],roomName:"",roomId:-1,actionList:[],sceneId:-1}},mounted(){this.getUrlParams(),window.__eventBus.on("addDevAction",o=>{o=p(o),this.actionList.push(o)})},methods:{getUrlParams(){let o=window.location.search;const e=E(o);console.log(e),e!=null&&"sceneId"in e&&(this.sceneId=e.sceneId,console.log(this.sceneId),this.sceneId!=null&&this.sceneId!=-1&&this.getSceneDetail())},getSceneDetail(){V(this.sceneId).then(o=>{o.data.sceneList.length>0?(this.scenename=o.data.sceneList[0].sceneName,this.roomName=o.data.sceneList[0].roomName,this.roomId=o.data.sceneList[0].roomId,this.actionList=o.data.sceneList[0].actionList,this.actionList.forEach(e=>{e.extension=JSON.parse(e.extension),e=p(e)})):a(o.info)}).catch(o=>console.log(o))},onClickLeft(){window.__jsb.pop()},onClickRight(){if(this.scenename==""){a("请输入情景名称");return}if(this.roomId==-1){a("请选择房间");return}if(this.actionList==null||this.actionList.length==0){a("最少要包含一个动作");return}this.actionList.forEach(o=>{o.extension!=null&&o.extension!=""&&(o.extension=JSON.stringify(o.extension))}),this.sceneId==-1?d(this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.forwardEvent("reload","","scene-manual","scene-list"),window.__jsb.pop()}).catch(o=>console.log(o)):y(this.sceneId,this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.forwardEvent("reload","","scene-manual","scene-list"),window.__jsb.pop()}).catch(o=>console.log(o))},delScene(){D(this.sceneId).then(o=>{window.__jsb.forwardEvent("reload","","scene-auto","scene-list"),window.__jsb.pop()}).catch(o=>{a(o)})},selRoom(){this.room_sel_show=!0,O().then(o=>{o.code==200?this.roomList=o.data.roomList:a(o.info)})},onRoomSelCancel(){this.room_sel_show=!1},onRoomSelConfirm(o){console.log("onRoomSelConfirm",o),this.roomName=o.roomName,this.roomId=o.roomId,this.room_sel_show=!1},addAction(){window.__jsb.push({route:"scene-action-type",params:{type:"manual"}})},actionRemove(o){this.actionList.splice(this.actionList.indexOf(o),1)}}},l=o=>(R("data-v-23a7fd5b"),o=o(),b(),o),J={class:"home"},q=l(()=>s("div",{class:"name_hint"}," 场景名称 ",-1)),T=l(()=>s("div",{class:"name_hint"}," 房间 ",-1)),z=l(()=>s("div",{class:"name_hint"}," 执行动作 ",-1)),G={class:"action"},H={class:"action_list"},K=["src"],Q={class:"action_info"},W={class:"action_dev_name"},X={class:"action_exec_name"},Y=l(()=>s("div",{class:"divider"},null,-1)),Z=l(()=>s("img",{class:"add_action_icon",src:B},null,-1)),$=l(()=>s("div",{class:"add_action_name"},"添加执行动作",-1)),oo=[Z,$];function eo(o,e,no,to,t,i){const u=j,_=x,f=N("RoomListPop"),w=F;return m(),r("div",J,[c(u,{class:"nav_bar",title:"手动场景","right-text":"保存",onClickRight:i.onClickRight,onClickLeft:i.onClickLeft},null,8,["onClickRight","onClickLeft"]),q,c(_,{class:"input",modelValue:t.scenename,"onUpdate:modelValue":e[0]||(e[0]=n=>t.scenename=n),clearable:"",placeholder:"请输入场景名称"},null,8,["modelValue"]),T,c(_,{class:"input",modelValue:t.roomName,"onUpdate:modelValue":e[1]||(e[1]=n=>t.roomName=n),onClick:i.selRoom,"right-icon":"arrow ",readonly:"",placeholder:"请选择房间"},null,8,["modelValue","onClick"]),z,(m(!0),r(g,null,L(t.actionList,n=>(m(),r("div",G,[s("div",H,[s("img",{class:"action_icon",src:n.icon},null,8,K),s("div",Q,[s("div",W,h(n.actionDevShowName),1),s("div",X,h(n.actionShowName),1)]),s("img",{class:"ic_remove",src:U,onClick:e[2]||(e[2]=io=>{i.actionRemove(t.item)})})]),Y]))),256)),s("div",{class:"add_action",onClick:e[3]||(e[3]=(...n)=>i.addAction&&i.addAction(...n))},oo),c(w,{show:t.room_sel_show,"onUpdate:show":e[4]||(e[4]=n=>t.room_sel_show=n),position:"bottom"},{default:S(()=>[c(f,{list:t.roomList,onOnCancal:i.onRoomSelCancel,onOnConfirm:i.onRoomSelConfirm},null,8,["list","onOnCancal","onOnConfirm"])]),_:1},8,["show"]),C(s("div",{class:"del_text",onClick:e[5]||(e[5]=(...n)=>i.delScene&&i.delScene(...n))},"删除场景",512),[[I,t.sceneId!=null&&t.sceneId!=-1]])])}const so=v(M,[["render",eo],["__scopeId","data-v-23a7fd5b"]]);k(so).mount("#root");
