import{_ as y,o as l,j as c,d as m,b as o,a,t as k,g as w,I as A,p as L,h as x,f as D,c as h,F as I,r as T,e as g,k as $,i as ee}from"./_plugin-vue_export-helper-ae94e834.js";/* empty css              */import{T as R,_ as P}from"./teenager-limit-c0a84a00.js";import{O as N}from"./index-6f826b23.js";import"./index-5198b2b7.js";import{B as j}from"./index-46966e79.js";import{I as V}from"./index-9cad779b.js";import{_ as B}from"./sign-task-527fe0df.js";import{E as se}from"./index-44c3c42c.js";import{P as te}from"./index-ca2a2be7.js";import{L as oe}from"./index-3d928aae.js";import{_ as ne}from"./accost-button-621bb3da.js";import{_ as ie}from"./safe-area-top-6391331c.js";import{_ as ae}from"./gradient-top-303d3c33.js";import{A as b}from"./api-3777ac7b.js";import{S as M,a as le,b as H,c as O,d as J}from"./index-af5b6666.js";/* empty css              */import{R as re}from"./real_person-47fbf4f0.js";import"./use-route-fa444ad9.js";import"./constant-eb256a74.js";import"./use-id-b8b960f0.js";import"./use-touch-b8f7fc8d.js";import"./use-expose-833097fe.js";import"./use-tab-status-ea9b54fd.js";import"./default_female_avatar-3bbfb1af.js";import"./function-call-d8608672.js";import"./index-c49f2c8f.js";import"./on-popup-reopen-34d1e964.js";import"./interceptor-c174082f.js";const ce={props:{show:{type:Boolean,default:!1},taskName:{type:String,default:"录语音签名"},taskValue:{type:Number,default:0}},watch:{show(e){this.visible=e}},computed:{type(){return this.gender===2?"积分":"金币"}},data(){return{TeenagerIcon:R,visible:!1,gender:0}},methods:{async getMyInfo(){const{data:e}=await API.getMyInfo();this.gender=e.gender},handleClose(){const e=localStorage.getItem("defaultSettings");let s={};e&&(s=JSON.parse(e)),localStorage.setItem("defaultSettings",JSON.stringify({...s,showTeenDialog:!1})),this.$emit("close")}}},_e=e=>(L("data-v-12d162c7"),e=e(),x(),e),de=_e(()=>o("div",{class:"title"},"恭喜完成任务",-1)),ge={class:"name"},pe={class:"value"},he={class:"type"},me={class:"tips"};function ue(e,s,r,p,t,n){const u=A,_=N;return l(),c(_,{show:t.visible,onClick:n.handleClose},{default:m(()=>[o("div",{class:"wrapper",onClick:s[1]||(s[1]=w(()=>{},["stop"]))},[o("div",{class:"close",onClick:s[0]||(s[0]=(...d)=>n.handleClose&&n.handleClose(...d))},[a(u,{name:"cross"})]),de,o("div",ge,k(r.taskName),1),o("div",pe,k(r.taskValue),1),o("div",he,k(n.type),1),o("div",me,k(n.type)+"已成功存入你的账户",1)])]),_:1},8,["show","onClick"])}const U=y(ce,[["render",ue],["__scopeId","data-v-12d162c7"]]);const fe={props:{show:{type:Boolean,default:!1}},watch:{show(e){this.visible=e}},data(){return{TeenagerIcon:R,visible:!1}},methods:{toTeenagerMode(){this.handleClose(),__jsb.push({route:"teenager-mode"})},handleClose(){const e=localStorage.getItem("defaultSettings");let s={};e&&(s=JSON.parse(e)),localStorage.setItem("defaultSettings",JSON.stringify({...s,showTeenDialog:!1})),this.$emit("close")}}},z=e=>(L("data-v-fd2d01e0"),e=e(),x(),e),ve=z(()=>o("div",{class:"title"},"青少年模式",-1)),ke=z(()=>o("div",{class:"cost"}," 为呵护未成年人健康成长，心遇特别推出青少年模式，该模式下心遇应用无法正常使用。请监护人主动选择，并设置监护密码。 ",-1));function we(e,s,r,p,t,n){const u=A,_=V,d=j,f=N;return l(),c(f,{show:t.visible,onClick:n.handleClose},{default:m(()=>[o("div",{class:"wrapper",onClick:s[2]||(s[2]=w(()=>{},["stop"]))},[o("div",{class:"close",onClick:s[0]||(s[0]=(...v)=>n.handleClose&&n.handleClose(...v))},[a(u,{name:"cross"})]),a(_,{src:t.TeenagerIcon},null,8,["src"]),ve,ke,o("div",{class:"set",onClick:s[1]||(s[1]=(...v)=>n.toTeenagerMode&&n.toTeenagerMode(...v))},"去设置青少年模式"),a(d,{class:"confirm",type:"primary",round:"",block:"",onClick:n.handleClose},{default:m(()=>[D("我知道了")]),_:1},8,["onClick"])])]),_:1},8,["show","onClick"])}const E=y(fe,[["render",we],["__scopeId","data-v-fd2d01e0"]]),ye=""+new URL("coin_female-9775a49f.svg",import.meta.url).href,Se=""+new URL("coin_male-e07d315e.svg",import.meta.url).href,Ce=""+new URL("date_icon-36607bbd.svg",import.meta.url).href;const be={name:"Home",components:{Skeleton:M,SkeletonTitle:le,SkeletonImage:H,SkeletonAvatar:O,SkeletonParagraph:J},data(){return{}}},Ie={class:"home-page-skeleton"},Te={style:{display:"flex",width:"100%",marginTop:"20px",marginBottom:"20px"}},Le={style:{flex:1,marginLeft:"12px"}},xe={style:{display:"flex",marginTop:"10px"}};function Ae(e,s,r,p,t,n){const u=O,_=J,d=H,f=M;return l(),h("div",Ie,[(l(),h(I,null,T(4,v=>a(f,{row:3,key:v},{template:m(()=>[o("div",Te,[a(u,{"avatar-size":"72"}),o("div",Le,[a(_,{"row-width":"60%"}),a(_),a(_),o("div",xe,[a(d,{"image-size":"80",style:{marginRight:"8px"}}),a(d,{"image-size":"80",style:{marginRight:"8px"}}),a(d,{"image-size":"80"})])])])]),_:2},1024)),64))])}const De=y(be,[["render",Ae],["__scopeId","data-v-b71ab24d"]]);const Re={name:"Home",components:{SignTask:B,TeenagerLimit:P,TeenagerDialog:E,TaskDialog:U,Skeleton:De},data(){return{CoinFemale:ye,CoinMale:Se,DateIcon:Ce,list:[],item:{},offset:0,refreshing:!1,loading:!1,pageLoading:!1,finished:!1,showSign:!1,showTeenDialog:!1,teenager:!1,showTask:!1}},created(){this.pageLoading=!0,this.getHomeRecommend(!0),this.getStorageParams(),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.getStorageParams()}),this.teenager&&(this.getSignStatus(),this.getTaskList())},computed:{myLike(){const{accountDynamicBO:e}=this.item;return(e==null?void 0:e.myLike)??!1}},methods:{toSet(){__jsb.push({route:"set-info"})},async getTaskList(){const{data:e}=await b.getTaskList(),{taskList:s}=e;s.find(p=>p.taskType===1)&&(this.showTask=!0)},async getStorageParams(){const e=localStorage.getItem("defaultSettings");if(e){const{teenager:s,showTeenDialog:r}=JSON.parse(e);this.teenager=s,this.showTeenDialog=r}},toPersonalInfo(){__jsb.push({route:"personal-info"})},async getSignStatus(){const{data:e}=await b.getSignStatus();this.signData=e;const{signed:s}=e;this.showSign=!s},toDetail(e){__jsb.push({route:"user-info",userInfo:e})},handleAssigment(){__jsb.push({route:"task-list"})},showImagePreviewAt(e,s){__jsb.invoke({scope:"window",method:"push",params:{route:"image-viewer",images:s==null?void 0:s.photoAlbum,startPosition:e,item:s,slot:!0}})},onRefresh(){this.refreshing=!0,this.offset=-1,this.getHomeRecommend(!0)},userInfo(e){const s=[];return e?(e.age&&s.push(`${e==null?void 0:e.age}岁`),e.height&&s.push(`${e.height}cm`),e.job&&s.push(e.job),s.join(" · ")):""},async getHomeRecommend(e){var p;if(this.teenager){this.refreshing=!1,this.loading=!1;return}this.loading=!0;const{data:s}=await b.getHomeRecommend({limit:20,offset:this.offset});Array.isArray(s)&&s.length<20&&(this.finished=!0);const r=Array.isArray(s)?s==null?void 0:s.map(t=>({...t,userInfo:this.userInfo(t)})):[];e?this.list=r:this.list=[...this.list,...r],this.offset=(p=s[s.length-1])==null?void 0:p.id,this.refreshing=!1,this.loading=!1,this.pageLoading=!1}}},S=e=>(L("data-v-e4324955"),e=e(),x(),e),Pe={class:"home-page"},Ne=S(()=>o("div",{class:"navbar"},[o("div",{class:"active"},"推荐")],-1)),je={key:1,class:"home-container"},Ve=["onClick"],Be=S(()=>o("div",{class:"item-circle-b"},[o("div",{class:"item-circle-s"})],-1)),Me={class:"item-right"},He={class:"head-row"},Oe={class:"name-column"},Je={class:"nickname"},Ue=S(()=>o("img",{src:re,alt:"",style:{"margin-left":"4px"}},null,-1)),ze=S(()=>o("div",{style:{height:"8px"}},null,-1)),Ee={class:"user-info"},Fe={class:"personal-sign"},qe={class:"photo-album"},Ge={key:2,class:"fixed-ad"};function Ke(e,s,r,p,t,n){const u=ae,_=ie,d=P,f=V,v=ne,F=oe,q=te,G=j,K=se,Q=$("skeleton"),W=B,X=E,Y=U;return l(),h("div",Pe,[a(u),a(_),Ne,t.teenager?(l(),c(d,{key:0})):g("",!0),!t.teenager&&!t.pageLoading?(l(),h("div",je,[t.list&&t.list.length||!t.finished?(l(),c(q,{key:0,modelValue:t.refreshing,"onUpdate:modelValue":s[1]||(s[1]=i=>t.refreshing=i),onRefresh:n.onRefresh},{default:m(()=>[a(F,{loading:t.loading,"onUpdate:loading":s[0]||(s[0]=i=>t.loading=i),finished:t.finished,"finished-text":"没有更多了哦 ~ ",onLoad:n.getHomeRecommend},{default:m(()=>[(l(!0),h(I,null,T(t.list,i=>(l(),h("div",{class:"home-item",key:i.id},[o("div",{class:"item-avatar",onClick:w(C=>n.toDetail(i),["prevent","stop"])},[a(f,{width:"72",height:"72",src:i==null?void 0:i.headPic,fit:"cover",radius:"30"},null,8,["src"]),Be],8,Ve),o("div",Me,[o("div",He,[o("div",Oe,[o("div",Je,[o("div",null,k(i.nickName),1),Ue]),ze,o("div",Ee,k(i.userInfo),1)]),a(v,{userInfo:i,onAccost:e.handleAccost},null,8,["userInfo","onAccost"])]),o("div",Fe,k(i.personalitySign),1),o("div",qe,[(l(!0),h(I,null,T(i==null?void 0:i.photoAlbum,(C,Z)=>(l(),c(f,{key:C,width:"80",height:"80",src:C,fit:"cover",radius:"2",class:"phpto",onClick:w(()=>n.showImagePreviewAt(Z,i),["stop"])},null,8,["src","onClick"]))),128))])])]))),128))]),_:1},8,["loading","finished","onLoad"])]),_:1},8,["modelValue","onRefresh"])):(l(),c(K,{key:1,description:"暂无数据"},{default:m(()=>[a(G,{round:"",class:"bottom-button",onClick:n.onRefresh,loading:t.loading},{default:m(()=>[D("刷新")]),_:1},8,["onClick","loading"])]),_:1}))])):g("",!0),!t.teenager&&!t.pageLoading?(l(),h("div",Ge,[g("",!0),a(f,{width:"72",height:"72",src:t.CoinMale,onClick:n.handleAssigment},null,8,["src","onClick"]),g("",!0)])):g("",!0),t.pageLoading?(l(),c(Q,{key:3})):g("",!0),t.showSign&&!t.teenager?(l(),c(W,{key:4,show:t.showSign,onClose:s[2]||(s[2]=i=>t.showSign=!1)},null,8,["show"])):g("",!0),t.showTeenDialog?(l(),c(X,{key:5,show:t.showTeenDialog,onClose:s[3]||(s[3]=i=>t.showTeenDialog=!1)},null,8,["show"])):g("",!0),t.showTask?(l(),c(Y,{key:6,show:t.showTask,onClose:s[4]||(s[4]=i=>t.showTask=!1)},null,8,["show"])):g("",!0)])}const Qe=y(Re,[["render",Ke],["__scopeId","data-v-e4324955"]]);ee(Qe).mount("#root");
