import{_ as k,c,b as a,a as i,w as _,h as w,v as D,o as n,F as L,r as C,t as p,f as N,p as x,g as E,d as R}from"./_plugin-vue_export-helper-051f66a3.js";import"./index-9d551784.js";import{E as y}from"./index-28005729.js";import{a as V,C as j}from"./index-38a4c887.js";import"./index-bf853e3e.js";import"./index-0f3161d3.js";import{F}from"./index-c3a7f1d1.js";import{_ as A}from"./nav-bar-a1dce73c.js";import{C as S,D as B,E as T,d as U,F as P}from"./api-c3130a22.js";import{g as q}from"./dev-image-f6fc399c.js";import{a as z}from"./function-call-753dd7bf.js";import"./use-id-ae36fcd7.js";import"./use-expose-1ff20361.js";import"./use-route-666d481f.js";import"./index-1c58f097.js";import"./use-touch-8855ff1b.js";import"./index-1c77c952.js";const G={data(){return{roomId:-1,homeId:-1,areaId:-1,roomName:"",deviceList:[],checked:[],initList:[],getDevImage:q}},mounted(){this.getParams(),this.findAllDev()},methods:{getParams(){let e={},o=window.location.search;if(o.indexOf("?")<0)return e;o=o.split("?")[1];let m=o.split("&");for(let t=0;t<m.length;t++){let l=m[t].split("=");e[l[0]]=l[1]}console.log(e),this.areaId=e.areaId,this.homeId=e.homeId,e.roomId!=null&&(this.roomId=e.roomId),e.roomName!=null&&(this.roomName=decodeURI(e.roomName))},onClickLeft(){window.__jsb.pop()},onClickRight(){if(this.roomName==""){z("请输入房间名");return}this.roomId==-1?S(this.roomName,this.homeId,this.areaId).then(e=>{this.roomId=e.data.room.roomId,this.batchEditDev()}).catch(e=>console.log(e)):B(this.roomName,this.homeId,this.areaId,this.roomId).then(e=>{this.batchEditDev()}).catch(e=>console.log(e))},batchEditDev(){if(this.checked.length==0){window.__jsb.pop();return}const e=[];this.checked.forEach(o=>{const d={};d.userDeviceId=o,d.roomId=this.roomId,e.push(d)}),T(e).then(o=>{window.__jsb.forwardEvent("reload","","roomedit","roomlist"),window.__jsb.pop()}).catch(o=>console.log(o))},findAllDev(){U().then(e=>{this.deviceList=e.data.userDeviceList,this.deviceList.forEach(o=>{o.roomId==this.roomId&&(this.checked.push(o.userDeviceId),this.initList.push(o.userDeviceId))})}).catch(e=>console.log(e))},deleteRoom(){P(this.homeId).then(e=>{window.__jsb.forwardEvent("reload","","roomedit","roomlist"),window.__jsb.pop()}).catch(e=>console.log(e))}}},v=e=>(x("data-v-51383b8b"),e=e(),E(),e),O={class:"home"},H=v(()=>i("div",{class:"name_hint"},"房间名称",-1)),J={class:"name_input"},K=v(()=>i("div",{class:"selected_dev_hint"},"请选择设备",-1)),M={class:"dev_content"},Q={key:0,class:"dev_list"},W={class:"floatleft"},X=["src"],Y={class:"dev_name"},Z={class:"floatright"},$={key:1};function ee(e,o,d,m,t,r){const l=A,u=F,f=j,I=V,g=y;return n(),c("div",O,[a(l,{title:"房间管理","right-text":"保存",onClickLeft:r.onClickLeft,onClickRight:r.onClickRight},null,8,["onClickLeft","onClickRight"]),i("div",null,[H,i("div",J,[a(u,{modelValue:t.roomName,"onUpdate:modelValue":o[0]||(o[0]=s=>t.roomName=s),rules:[{required:!0,message:"房间名称不能为空"}],placeholder:"请输入房间名称"},null,8,["modelValue"])])]),K,i("div",M,[t.deviceList!=null&&t.deviceList.length>0?(n(),c("div",Q,[a(I,{modelValue:t.checked,"onUpdate:modelValue":o[1]||(o[1]=s=>t.checked=s)},{default:_(()=>[(n(!0),c(L,null,C(t.deviceList,(s,b)=>{var h;return n(),c("div",{class:"divv",key:b},[i("div",W,[i("img",{class:"deviceImg",src:t.getDevImage((h=s.device)==null?void 0:h.cateType)},null,8,X),i("span",Y,p(s.deviceName),1)]),i("div",Z,[a(f,{"label-position":"left","checked-color":"#FD7D28",disabled:t.initList.includes(s.userDeviceId),name:s.userDeviceId},{default:_(()=>[N(p(s.roomName),1)]),_:2},1032,["disabled","name"])])])}),128))]),_:1},8,["modelValue"])])):(n(),c("div",$,[a(g,{"image-size":"80",description:"账号下没有设备"})]))]),w(i("div",{class:"del_text",onClick:o[2]||(o[2]=(...s)=>r.deleteRoom&&r.deleteRoom(...s))},"删除房间",512),[[D,t.homeId!=-1]])])}const oe=k(G,[["render",ee],["__scopeId","data-v-51383b8b"]]);R(oe).mount("#root");
