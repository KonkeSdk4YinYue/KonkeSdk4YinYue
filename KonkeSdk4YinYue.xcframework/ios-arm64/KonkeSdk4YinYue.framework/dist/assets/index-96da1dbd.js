import{m as T,y as b,q as E,u as v,aa as W,au as q,a0 as C,B as P,D as L,E as M,a as i,I,aH as X,ad as R,aD as y,X as $,w as A}from"./_plugin-vue_export-helper-ae94e834.js";import{u as H}from"./use-expose-833097fe.js";import{o as O}from"./on-popup-reopen-34d1e964.js";const[V,c]=T("notice-bar"),_={text:String,mode:String,color:String,delay:b(1),speed:b(60),leftIcon:String,wrapable:Boolean,background:String,scrollable:{type:Boolean,default:null}};var j=E({name:V,props:_,emits:["close","replay"],setup(e,{emit:m,slots:a}){let l=0,o=0,h;const u=v(),d=v(),t=W({show:!0,offset:0,duration:0}),p=()=>{if(a["left-icon"])return a["left-icon"]();if(e.leftIcon)return i(I,{class:c("left-icon"),name:e.leftIcon},null)},x=()=>{if(e.mode==="closeable")return"cross";if(e.mode==="link")return"arrow"},k=n=>{e.mode==="closeable"&&(t.show=!1,m("close",n))},N=()=>{if(a["right-icon"])return a["right-icon"]();const n=x();if(n)return i(I,{name:n,class:c("right-icon"),onClick:k},null)},S=()=>{t.offset=l,t.duration=0,X(()=>{y(()=>{t.offset=-o,t.duration=(o+l)/+e.speed,m("replay")})})},B=()=>{const n=e.scrollable===!1&&!e.wrapable,s={transform:t.offset?`translateX(${t.offset}px)`:"",transitionDuration:`${t.duration}s`};return i("div",{ref:u,role:"marquee",class:c("wrap")},[i("div",{ref:d,style:s,class:[c("content"),{"van-ellipsis":n}],onTransitionend:S},[a.default?a.default():e.text])])},r=()=>{const{delay:n,speed:s,scrollable:f}=e,D=$(n)?+n*1e3:0;l=0,o=0,t.offset=0,t.duration=0,clearTimeout(h),h=setTimeout(()=>{if(!u.value||!d.value||f===!1)return;const w=R(u).width,g=R(d).width;(f||g>w)&&y(()=>{l=w,o=g,t.offset=-o,t.duration=o/+s})},D)};return O(r),q(r),C("pageshow",r),H({reset:r}),P(()=>[e.text,e.scrollable],r),()=>{const{color:n,wrapable:s,background:f}=e;return L(i("div",{role:"alert",class:c({wrapable:s}),style:{color:n,background:f}},[p(),B(),N()]),[[M,t.show]])}}});const J=A(j);export{J as N};
