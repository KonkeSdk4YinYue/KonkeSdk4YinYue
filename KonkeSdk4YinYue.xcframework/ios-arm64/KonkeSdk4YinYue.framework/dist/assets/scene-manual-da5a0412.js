import{_ as v,c as r,b as c,F as g,r as L,a as s,w as S,f as C,v as I,o as m,t as h,p as b,e as R,g as k,h as N}from"./_plugin-vue_export-helper-c6b04c4a.js";import"./index-31b7c571.js";/* empty css              */import"./index-7bc1b107.js";import{F as x}from"./index-c30f7602.js";import{_ as j}from"./nav-bar-721d5a93.js";import{R as A,_ as P,a as V}from"./ic_scene_add_action-888c5285.js";import{S as y}from"./scene-action-light-component-164e5297.js";import{i as D,j as d,k as O,l as E,r as U}from"./api-e1bed118.js";import{g as B}from"./urlparse-f25d0f77.js";import{p}from"./scene-cfbe032f.js";import{s as a}from"./function-call-8de52e48.js";import{P as F}from"./index-03f6bb18.js";import"./use-route-3612c525.js";import"./use-id-23bdf568.js";import"./use-touch-c5100371.js";import"./index-066b1e6c.js";import"./index-d2ea230b.js";import"./index-7882f3c6.js";/* empty css              */import"./index-8310b73f.js";import"./index-860b8b59.js";import"./index-22da9197.js";import"./dev-image-f6fc399c.js";import"./ic_scene1-0f866639.js";const M={components:{SceneActionLight:y,RoomListPop:A},data(){return{scenename:"",item:null,value:0,room_sel_show:!1,roomList:[],roomName:"",roomId:-1,actionList:[],sceneId:-1}},mounted(){this.getUrlParams(),window.__eventBus.on("addDevAction",o=>{o=p(o),this.actionList.push(o)})},methods:{getUrlParams(){let o=window.location.search;const e=B(o);console.log(e),e!=null&&"sceneId"in e&&(this.sceneId=e.sceneId,console.log(this.sceneId),this.sceneId!=null&&this.sceneId!=-1&&this.getSceneDetail())},getSceneDetail(){D(this.sceneId).then(o=>{o.data.sceneList.length>0?(this.scenename=o.data.sceneList[0].sceneName,this.roomName=o.data.sceneList[0].roomName,this.roomId=o.data.sceneList[0].roomId,this.actionList=o.data.sceneList[0].actionList,this.actionList.forEach(e=>{e.extension=JSON.parse(e.extension),e=p(e)})):a(o.info)}).catch(o=>console.log(o))},onClickLeft(){window.__jsb.pop()},onClickRight(){if(this.scenename==""){a("请输入情景名称");return}if(this.roomId==-1){a("请选择房间");return}if(this.actionList==null||this.actionList.length==0){a("最少要包含一个动作");return}this.actionList.forEach(o=>{o.extension!=null&&o.extension!=""&&(o.extension=JSON.stringify(o.extension))}),this.sceneId==-1?d(this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.forwardEvent("reload","","scene-manual","scene-list"),window.__jsb.pop()}).catch(o=>console.log(o)):O(this.sceneId,this.scenename,"Normal",this.roomId,[],this.actionList).then(o=>{console.log("addManualScene",d),window.__jsb.forwardEvent("reload","","scene-manual","scene-list"),window.__jsb.pop()}).catch(o=>console.log(o))},delScene(){E(this.sceneId).then(o=>{window.__jsb.forwardEvent("reload","","scene-auto","scene-list"),window.__jsb.pop()}).catch(o=>{a(o)})},selRoom(){this.room_sel_show=!0,U().then(o=>{o.code==200?this.roomList=o.data.roomList:a(o.info)})},onRoomSelCancel(){this.room_sel_show=!1},onRoomSelConfirm(o){console.log("onRoomSelConfirm",o),this.roomName=o.roomName,this.roomId=o.roomId,this.room_sel_show=!1},addAction(){window.__jsb.push({route:"scene-action-type",params:{type:"manual"}})},actionRemove(o){this.actionList.splice(this.actionList.indexOf(o),1)}}},l=o=>(b("data-v-23a7fd5b"),o=o(),R(),o),J={class:"home"},T=l(()=>s("div",{class:"name_hint"}," 场景名称 ",-1)),q=l(()=>s("div",{class:"name_hint"}," 房间 ",-1)),z=l(()=>s("div",{class:"name_hint"}," 执行动作 ",-1)),G={class:"action"},H={class:"action_list"},K=["src"],Q={class:"action_info"},W={class:"action_dev_name"},X={class:"action_exec_name"},Y=l(()=>s("div",{class:"divider"},null,-1)),Z=l(()=>s("img",{class:"add_action_icon",src:V},null,-1)),$=l(()=>s("div",{class:"add_action_name"},"添加执行动作",-1)),oo=[Z,$];function eo(o,e,no,to,t,i){const u=j,_=x,f=k("RoomListPop"),w=F;return m(),r("div",J,[c(u,{class:"nav_bar",title:"手动场景","right-text":"保存",onClickRight:i.onClickRight,onClickLeft:i.onClickLeft},null,8,["onClickRight","onClickLeft"]),T,c(_,{class:"input",modelValue:t.scenename,"onUpdate:modelValue":e[0]||(e[0]=n=>t.scenename=n),clearable:"",placeholder:"请输入场景名称"},null,8,["modelValue"]),q,c(_,{class:"input",modelValue:t.roomName,"onUpdate:modelValue":e[1]||(e[1]=n=>t.roomName=n),onClick:i.selRoom,"right-icon":"arrow ",readonly:"",placeholder:"请选择房间"},null,8,["modelValue","onClick"]),z,(m(!0),r(g,null,L(t.actionList,n=>(m(),r("div",G,[s("div",H,[s("img",{class:"action_icon",src:n.icon},null,8,K),s("div",Q,[s("div",W,h(n.actionDevShowName),1),s("div",X,h(n.actionShowName),1)]),s("img",{class:"ic_remove",src:P,onClick:e[2]||(e[2]=io=>{i.actionRemove(t.item)})})]),Y]))),256)),s("div",{class:"add_action",onClick:e[3]||(e[3]=(...n)=>i.addAction&&i.addAction(...n))},oo),c(w,{show:t.room_sel_show,"onUpdate:show":e[4]||(e[4]=n=>t.room_sel_show=n),position:"bottom"},{default:S(()=>[c(f,{list:t.roomList,onOnCancal:i.onRoomSelCancel,onOnConfirm:i.onRoomSelConfirm},null,8,["list","onOnCancal","onOnConfirm"])]),_:1},8,["show"]),C(s("div",{class:"del_text",onClick:e[5]||(e[5]=(...n)=>i.delScene&&i.delScene(...n))},"删除场景",512),[[I,t.sceneId!=null&&t.sceneId!=-1]])])}const so=v(M,[["render",eo],["__scopeId","data-v-23a7fd5b"]]);N(so).mount("#root");
